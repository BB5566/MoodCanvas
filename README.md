# ğŸ¨ MoodCanvas - AI æƒ…ç·’æ—¥è¨˜

> **è®“æ¯ä¸€å¤©çš„æ„Ÿå—ï¼Œéƒ½æˆç‚ºè—è¡“**

[![PHP Version](https://img.shields.io/badge/PHP-7.4+-blue.svg)](https://php.net)
[![MySQL](https://img.shields.io/badge/MySQL-5.7+-orange.svg)](https://mysql.com)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)
[![PRs Welcome](https://img.shields.io/badge/PRs-welcome-brightgreen.svg)](CONTRIBUTING.md)

MoodCanvas æ˜¯ä¸€å€‹å‰µæ–°çš„æƒ…ç·’æ—¥è¨˜æ‡‰ç”¨ç¨‹å¼ï¼Œçµåˆå‚³çµ±æ—¥è¨˜å¯«ä½œèˆ‡ç¾ä»£ AI æŠ€è¡“ï¼Œé€éæ™ºæ…§åœ–åƒç”Ÿæˆå’Œæƒ…æ„Ÿåˆ†æï¼Œå°‡æ‚¨çš„æ–‡å­—è½‰åŒ–ç‚ºè¦–è¦ºè—è¡“ï¼Œè®“æ¯ä¸€å¤©çš„å¿ƒæƒ…éƒ½èƒ½è¢«ç”Ÿå‹•åœ°è¨˜éŒ„å’Œå›å‘³ã€‚

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

### ğŸ“… æ™ºæ…§å¿ƒæƒ…æ—¥æ›†
- **è¦–è¦ºåŒ–å¿ƒæƒ…è¿½è¹¤** - ç›´è§€ç€è¦½æ¯æ—¥æƒ…ç·’è®ŠåŒ–
- **å¤šæ—¥è¨˜æ”¯æ´** - åŒä¸€å¤©å¯è¨˜éŒ„å¤šç¯‡å¿ƒæƒ…
- **å¿ƒæƒ…çµ±è¨ˆ** - è‡ªå‹•è¨ˆç®—æƒ…ç·’åˆ†ä½ˆå’Œè¶¨å‹¢

### ğŸ–¼ï¸ AI åœ–åƒç”Ÿæˆ
- **Vertex AI é©…å‹•** - Google æœ€æ–°çš„ Imagen æ¨¡å‹
- **å¤šç¨®è—è¡“é¢¨æ ¼** - å‰åœåŠ›ã€å¯«å¯¦æ”å½±ã€æ¢µè°·ã€åº·ä¸æ–¯åŸºç­‰
- **æ™ºæ…§æç¤ºè©å„ªåŒ–** - è‡ªå‹•åˆ†ææ—¥è¨˜å…§å®¹ç”Ÿæˆç²¾æº–åœ–ç‰‡
- **æƒ…æ„Ÿæ°›åœæ˜ å°„** - æ ¹æ“šå¿ƒæƒ…è‡ªå‹•èª¿æ•´ç‡ˆå…‰å’Œè‰²èª¿

### ğŸ’¬ AI å¿ƒæƒ…çŸ­èª
- **Perplexity AI é©…å‹•** - ç”Ÿæˆå¯Œæœ‰è©©æ„çš„å¿ƒæƒ…è¨»è§£
- **å¤šèªè¨€æ”¯æ´** - æ™ºæ…§åˆ¤æ–·è¼¸å‡ºä¸­æ–‡æˆ–è‹±æ–‡
- **æƒ…å¢ƒæ„ŸçŸ¥** - æ ¹æ“šæ—¥è¨˜å…§å®¹ç”Ÿæˆè²¼åˆ‡çš„çŸ­èª

### ğŸ“Š æƒ…ç·’æ´å¯Ÿå„€è¡¨æ¿
- **ç†±åŠ›åœ–åˆ†æ** - è¦–è¦ºåŒ–å¿ƒæƒ…åˆ†ä½ˆ
- **è¶¨å‹¢åœ–è¡¨** - è¿½è¹¤é•·æœŸæƒ…ç·’è®ŠåŒ–
- **è©é›²å±•ç¤º** - åˆ†æå¸¸ç”¨è©å½™å’Œä¸»é¡Œ
- **AI æ™ºæ…§æ´å¯Ÿ** - å°ˆæ¥­å¿ƒç†åˆ†æèˆ‡å»ºè­°

### ğŸ”’ å®‰å…¨èˆ‡é«”é©—
- **ä½¿ç”¨è€…èªè­‰ç³»çµ±** - å®‰å…¨çš„è¨»å†Šç™»å…¥æ©Ÿåˆ¶
- **éŸ¿æ‡‰å¼è¨­è¨ˆ** - å®Œç¾é©é…æ‰‹æ©Ÿã€å¹³æ¿ã€æ¡Œé¢
- **æ—¥ç³»ç°¡ç´„é¢¨æ ¼** - æ–‡é’é«˜ç´šçš„è¦–è¦ºè¨­è¨ˆ
- **éš±ç§ä¿è­·** - æ‚¨çš„æ—¥è¨˜åªå±¬æ–¼æ‚¨

## ğŸš€ æŠ€è¡“æ¶æ§‹

### å¾Œç«¯æŠ€è¡“æ£§
- **PHP 7.4+** - ç¾ä»£åŒ– MVC æ¶æ§‹
- **MySQL/MariaDB** - å¯é çš„è³‡æ–™å„²å­˜
- **è‡ªå®šç¾©è·¯ç”±ç³»çµ±** - éˆæ´»çš„ URL è™•ç†
- **Adapter è¨­è¨ˆæ¨¡å¼** - æ¨¡çµ„åŒ– AI æœå‹™æ•´åˆ

### å‰ç«¯æŠ€è¡“æ£§
- **HTML5 + CSS3** - èªç¾©åŒ–æ¨™è¨˜èˆ‡ç¾ä»£æ¨£å¼
- **åŸç”Ÿ JavaScript** - è¼•é‡åŒ–äº’å‹•é«”é©—
- **Chart.js + D3.js** - å°ˆæ¥­è³‡æ–™è¦–è¦ºåŒ–
- **éŸ¿æ‡‰å¼è¨­è¨ˆ** - Mobile-First é–‹ç™¼ç†å¿µ

### AI æœå‹™æ•´åˆ
- **Google Vertex AI** - ä¼æ¥­ç´šåœ–åƒç”Ÿæˆ
- **Perplexity AI** - æ™ºæ…§æ–‡å­—ç”Ÿæˆ
- **Google Gemini** - å¤šæ¨¡æ…‹ AI æ”¯æ´
- **Stability AI** - å‚™ç”¨åœ–åƒæœå‹™

## ğŸ—ï¸ ç³»çµ±æ¶æ§‹åœ–

```mermaid
graph TB
    subgraph "å‰ç«¯å±¤"
        A[éŸ¿æ‡‰å¼ç¶²é ä»‹é¢]
        B[æ—¥æ›†è¦–åœ–]
        C[å„€è¡¨æ¿]
        D[æ—¥è¨˜ç·¨è¼¯å™¨]
    end

    subgraph "æ‡‰ç”¨å±¤"
        E[MVC æ§åˆ¶å™¨]
        F[èªè­‰ä¸­ä»‹è»Ÿé«”]
        G[API è·¯ç”±]
    end

    subgraph "æ¥­å‹™é‚è¼¯å±¤"
        H[æ—¥è¨˜ç®¡ç†]
        I[ç”¨æˆ¶ç®¡ç†]
        J[AI æœå‹™ç®¡ç†]
    end

    subgraph "AI æœå‹™å±¤"
        K[Perplexity Adapter]
        L[Vertex AI Adapter]
        M[Gemini Adapter]
    end

    subgraph "è³‡æ–™å±¤"
        N[MySQL è³‡æ–™åº«]
        O[æª”æ¡ˆç³»çµ±]
        P[æ—¥èªŒç³»çµ±]
    end

    A --> E
    B --> E
    C --> E
    D --> E
    E --> F
    E --> G
    F --> H
    F --> I
    G --> J
    J --> K
    J --> L
    J --> M
    H --> N
    I --> N
    J --> O
    E --> P
```

## ğŸ“‹ å®‰è£æŒ‡å—

### ç³»çµ±éœ€æ±‚

- **PHP 7.4+** (å»ºè­° 8.0+)
- **MySQL 5.7+** æˆ– **MariaDB 10.3+**
- **Apache 2.4+** æˆ– **Nginx 1.18+**
- **è‡³å°‘ 512MB è¨˜æ†¶é«”**
- **1GB å¯ç”¨ç¡¬ç¢Ÿç©ºé–“**

### å¿«é€Ÿå®‰è£

#### 1. ä¸‹è¼‰å°ˆæ¡ˆ
```bash
git clone https://github.com/your-username/MoodCanvas.git
cd MoodCanvas
```

#### 2. ç’°å¢ƒé…ç½®
```bash
# è¤‡è£½ç’°å¢ƒé…ç½®æª”æ¡ˆ
cp .env.example .env

# ç·¨è¼¯é…ç½® (è«‹åƒè€ƒä¸‹æ–¹è©³ç´°é…ç½®èªªæ˜)
nano .env
```

#### 3. è³‡æ–™åº«è¨­å®š
```bash
# ç™»å…¥ MySQL
mysql -u root -p

# å‰µå»ºè³‡æ–™åº«
CREATE DATABASE mood_canvas_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

# å‰µå»ºç”¨æˆ¶ (å¯é¸)
CREATE USER 'moodcanvas'@'localhost' IDENTIFIED BY 'your_secure_password';
GRANT ALL PRIVILEGES ON mood_canvas_db.* TO 'moodcanvas'@'localhost';
FLUSH PRIVILEGES;

# åŒ¯å…¥è³‡æ–™åº«çµæ§‹
mysql -u moodcanvas -p mood_canvas_db < database/mood_canvas_schema.sql
```

#### 4. Web ä¼ºæœå™¨é…ç½®

**Apache (.htaccess å·²åŒ…å«)**
```apache
# ç¢ºä¿ mod_rewrite å·²å•Ÿç”¨
sudo a2enmod rewrite
sudo systemctl restart apache2

# è™›æ“¬ä¸»æ©Ÿç¯„ä¾‹
<VirtualHost *:80>
    DocumentRoot /path/to/MoodCanvas/public
    ServerName moodcanvas.local

    <Directory /path/to/MoodCanvas/public>
        AllowOverride All
        Require all granted
    </Directory>
</VirtualHost>
```

**Nginx**
```nginx
server {
    listen 80;
    server_name moodcanvas.local;
    root /path/to/MoodCanvas/public;
    index index.php;

    location / {
        try_files $uri $uri/ /index.php?$query_string;
    }

    location ~ \.php$ {
        fastcgi_pass unix:/var/run/php/php8.0-fpm.sock;
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        include fastcgi_params;
    }

    # å®‰å…¨è¨­å®š
    location ~ /\. {
        deny all;
    }

    location ~* \.(log|sql)$ {
        deny all;
    }
}
```

#### 5. æª”æ¡ˆæ¬Šé™è¨­å®š
```bash
# è¨­å®šé©ç•¶çš„æª”æ¡ˆæ¬Šé™
chmod -R 755 .
chmod -R 777 public/storage/generated_images
chmod -R 777 logs
chmod 600 .env
chmod 600 config/gcp-service-account.json
```

## ğŸ”§ AI æœå‹™é…ç½®

### Perplexity AI (å¿…é ˆ)
1. å‰å¾€ [Perplexity API](https://www.perplexity.ai/settings/api)
2. å‰µå»ºå¸³æˆ¶ä¸¦å–å¾— API Key
3. åœ¨ `.env` ä¸­è¨­å®šï¼š
```bash
PERPLEXITY_API_KEY="pplx-your-api-key-here"
PERPLEXITY_MODEL="sonar"
```

### Google Vertex AI (æ¨è–¦)
1. å‰å¾€ [Google Cloud Console](https://console.cloud.google.com)
2. å‰µå»ºæ–°å°ˆæ¡ˆæˆ–é¸æ“‡ç¾æœ‰å°ˆæ¡ˆ
3. å•Ÿç”¨ Vertex AI API
4. å‰µå»ºæœå‹™å¸³æˆ¶ï¼š
   - IAM & Admin â†’ Service Accounts
   - å‰µå»ºæœå‹™å¸³æˆ¶
   - ä¸‹è¼‰ JSON é‡‘é‘°æª”æ¡ˆ
   - å°‡æª”æ¡ˆé‡å‘½åç‚º `gcp-service-account.json` ä¸¦æ”¾å…¥ `config/` ç›®éŒ„
5. åœ¨ `.env` ä¸­è¨­å®šï¼š
```bash
GCP_PROJECT_ID="your-project-id"
GCP_REGION="us-central1"
```

### Google Gemini (é¸ç”¨)
1. å‰å¾€ [Google AI Studio](https://aistudio.google.com/app/apikey)
2. å–å¾— API Key
3. åœ¨ `.env` ä¸­è¨­å®šï¼š
```bash
GEMINI_API_KEY="your-gemini-api-key"
GEMINI_TEXT_MODEL="gemini-2.5-flash"
```

### Stability AI (é¸ç”¨)
1. å‰å¾€ [Stability AI](https://platform.stability.ai/account/keys)
2. å–å¾— API Key
3. åœ¨ `.env` ä¸­è¨­å®šï¼š
```bash
STABILITY_API_KEY="sk-your-stability-key"
STABILITY_MODEL="stable-diffusion-xl-1024-v1-0"
```

## ğŸ¯ .env å®Œæ•´é…ç½®ç¯„ä¾‹

```bash
# === AI æœå‹™é…ç½® ===
PERPLEXITY_API_KEY="pplx-your-key-here"
PERPLEXITY_MODEL="sonar"

GCP_PROJECT_ID="your-gcp-project"
GCP_REGION="us-central1"

GEMINI_API_KEY="your-gemini-key"
GEMINI_TEXT_MODEL="gemini-2.5-flash"

# === è³‡æ–™åº«é…ç½® ===
DB_HOST=localhost
DB_PORT=3306
DB_NAME=mood_canvas_db
DB_USER=moodcanvas
DB_PASS=your_secure_password

# === æ‡‰ç”¨ç¨‹å¼é…ç½® ===
DEBUG=false
APP_URL=https://your-domain.com

# === å®‰å…¨è¨­å®š ===
SESSION_TIMEOUT=3600
ENABLE_SECURITY_CHECKS=true
RATE_LIMIT_ENABLED=true
```

## ğŸ“Š è³‡æ–™åº«çµæ§‹

### ERD åœ–è¡¨
```mermaid
erDiagram
    users {
        int id PK
        varchar username UK
        varchar password_hash
        varchar email
        timestamp created_at
        timestamp updated_at
    }

    diaries {
        int id PK
        int user_id FK
        varchar title
        text content
        varchar mood
        date diary_date
        varchar image_path
        text ai_generated_text
        text image_prompt
        timestamp created_at
        timestamp updated_at
    }

    generated_images {
        int id PK
        int diary_id FK
        varchar image_path
        text prompt
        json api_response
        timestamp created_at
    }

    users ||--o{ diaries : writes
    diaries ||--o{ generated_images : generates
```

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è¦‹å•é¡Œ

#### 1. AI åœ–ç‰‡ç”Ÿæˆå¤±æ•—
**ç—‡ç‹€**: åœ–ç‰‡ç”Ÿæˆè¿”å›éŒ¯èª¤æˆ–ç©ºç™½
**è§£æ±ºæ–¹æ¡ˆ**:
- æª¢æŸ¥ Vertex AI æœå‹™å¸³æˆ¶è¨­å®š
- ç¢ºèªå°ˆæ¡ˆ ID å’Œå€åŸŸæ­£ç¢º
- æª¢æŸ¥ API é…é¡å’Œè¨ˆè²»ç‹€æ…‹

#### 2. è³‡æ–™åº«é€£ç·šå¤±æ•—
**ç—‡ç‹€**: ç„¡æ³•è¼‰å…¥é é¢ï¼Œé¡¯ç¤ºè³‡æ–™åº«éŒ¯èª¤
**è§£æ±ºæ–¹æ¡ˆ**:
- æª¢æŸ¥ `.env` ä¸­çš„è³‡æ–™åº«è¨­å®š
- ç¢ºèª MySQL æœå‹™æ­£åœ¨é‹è¡Œ
- é©—è­‰ç”¨æˆ¶æ¬Šé™

#### 3. AI æ–‡å­—ç”Ÿæˆå¤±æ•—
**ç—‡ç‹€**: å¿ƒæƒ…çŸ­èªç„¡æ³•ç”Ÿæˆ
**è§£æ±ºæ–¹æ¡ˆ**:
- æª¢æŸ¥ Perplexity API Key
- ç¢ºèªç¶²è·¯é€£ç·š
- æª¢æŸ¥ API é…é¡

#### 4. æª”æ¡ˆä¸Šå‚³æ¬Šé™éŒ¯èª¤
**ç—‡ç‹€**: ç„¡æ³•å„²å­˜ç”Ÿæˆçš„åœ–ç‰‡
**è§£æ±ºæ–¹æ¡ˆ**:
```bash
chmod -R 777 public/storage/generated_images
chown -R www-data:www-data public/storage
```

### æ—¥èªŒæª¢æŸ¥
```bash
# æª¢æŸ¥æ‡‰ç”¨ç¨‹å¼æ—¥èªŒ
tail -f logs/app.log

# æª¢æŸ¥éŒ¯èª¤æ—¥èªŒ
tail -f logs/error.log

# æª¢æŸ¥ Web ä¼ºæœå™¨æ—¥èªŒ
tail -f /var/log/apache2/error.log  # Apache
tail -f /var/log/nginx/error.log    # Nginx
```

## ğŸš€ éƒ¨ç½²åˆ°ç”Ÿç”¢ç’°å¢ƒ

### å®‰å…¨æª¢æŸ¥æ¸…å–®
- [ ] è¨­å®š `DEBUG=false`
- [ ] ä½¿ç”¨ HTTPS
- [ ] è¨­å®šå¼·å¯†ç¢¼
- [ ] æ›´æ–°æ‰€æœ‰ API Keys
- [ ] è¨­å®šé©ç•¶çš„æª”æ¡ˆæ¬Šé™
- [ ] å•Ÿç”¨é˜²ç«ç‰†
- [ ] è¨­å®šå®šæœŸå‚™ä»½

### æ•ˆèƒ½å„ªåŒ–
- [ ] å•Ÿç”¨ OpCache
- [ ] è¨­å®šåå‘ä»£ç†å¿«å–
- [ ] å£“ç¸®éœæ…‹è³‡æº
- [ ] è¨­å®š CDN (å¯é¸)

### ç›£æ§è¨­å®š
- [ ] è¨­å®šæ—¥èªŒè¼ªæ›¿
- [ ] ç›£æ§ç£ç¢Ÿç©ºé–“
- [ ] è¨­å®š SSL æ†‘è­‰è‡ªå‹•æ›´æ–°
- [ ] å»ºç«‹å¥åº·æª¢æŸ¥ç«¯é»

## ğŸ¤ è²¢ç»æŒ‡å—

æˆ‘å€‘æ­¡è¿ä»»ä½•å½¢å¼çš„è²¢ç»ï¼

### å¦‚ä½•è²¢ç»
1. Fork æ­¤å°ˆæ¡ˆ
2. å‰µå»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some amazing feature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/amazing-feature`)
5. é–‹å•Ÿ Pull Request

### é–‹ç™¼è¨­å®š
```bash
# å•Ÿç”¨é–‹ç™¼æ¨¡å¼
DEBUG=true

# å®‰è£é–‹ç™¼ä¾è³´
composer install --dev

# é‹è¡Œæ¸¬è©¦ (å¦‚æœæœ‰)
php tests/run-tests.php
```

## ğŸ“„ æˆæ¬Šæ¢æ¬¾

æ­¤å°ˆæ¡ˆæ¡ç”¨ MIT æˆæ¬Šæ¢æ¬¾ - è©³è¦‹ [LICENSE](LICENSE) æª”æ¡ˆ

## ğŸ¨ è¨­è¨ˆç†å¿µ

MoodCanvas çš„è¨­è¨ˆéˆæ„Ÿä¾†è‡ªæ–¼æ—¥æœ¬çš„ **ç‰©ã®å“€ã‚Œ** (mono no aware) æ¦‚å¿µï¼Œå¼·èª¿å°äº‹ç‰©ç„¡å¸¸ä¹‹ç¾çš„æ„ŸçŸ¥ã€‚æˆ‘å€‘å¸Œæœ›é€é AI æŠ€è¡“ï¼Œå¹«åŠ©ç”¨æˆ¶æ›´æ·±åˆ»åœ°ç†è§£å’Œè¡¨é”è‡ªå·±çš„æƒ…æ„Ÿï¼Œå°‡æ¯ä¸€å¤©çš„å¿ƒæƒ…è½‰åŒ–ç‚ºæ°¸æ†çš„è—è¡“ä½œå“ã€‚

## ğŸŒŸ è‡´è¬

- **Google Vertex AI** - æä¾›å¼·å¤§çš„åœ–åƒç”Ÿæˆèƒ½åŠ›
- **Perplexity AI** - æä¾›æ™ºæ…§çš„æ–‡å­—ç”Ÿæˆæœå‹™
- **Chart.js & D3.js** - å„ªç§€çš„è³‡æ–™è¦–è¦ºåŒ–å·¥å…·
- **æ‰€æœ‰è²¢ç»è€…** - è®“ MoodCanvas è®Šå¾—æ›´å¥½

---

<div align="center">

**MoodCanvas** - *è®“æ‚¨çš„å¿ƒæƒ…ï¼Œæˆç‚ºè—è¡“* ğŸ¨âœ¨

[ğŸŒ å®˜æ–¹ç¶²ç«™](https://moodcanvas.com) â€¢ [ğŸ“– æ–‡æª”](https://docs.moodcanvas.com) â€¢ [ğŸ› å›å ±å•é¡Œ](https://github.com/your-username/MoodCanvas/issues) â€¢ [ğŸ’¬ è¨è«–å€](https://github.com/your-username/MoodCanvas/discussions)

</div>
